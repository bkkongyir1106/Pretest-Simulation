---
title: "Density plots of t test statistic under H1"
author: "Benedict Kongyir"
date: "`r format(Sys.time(), '%m/%d/%Y')`"
output: 
  html_document: 
    toc: yes
    toc_float: yes
    number_sections: yes
    code_folding: hide
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r}
num.sim <- 1e5
n <- 10
df <- 3
deltavec <- c(0.5, 1 ,1.5)
```



```{r}
tstat_norm <- tstat_chi <- tstat_exp <- tstat_unif <- tstat_t <- tstat_gamma <- tstat_weibull <- tstat_log <- matrix(NA, nrow = num.sim, ncol = length(deltavec))
```


```{r}
set.seed(123)
for(i in 1:num.sim){
  for (k in 1:length(deltavec)){
    chisq_distn <- (rchisq(n, df) - df)/sqrt(2*df) + deltavec[k]
    exp_distn <- (rexp(n) - 1) + deltavec[k]
    unif_distn <- (runif(n, 0, 1) - 0.5)/sqrt(1/12) + deltavec[k]
    t_distn <- (rt(n, df))/sqrt(df/(df-2)) + deltavec[k]
    norm_dist<- rnorm(n) + deltavec[k]
    gamma_dist <- ((rgamma(n, shape = 3, rate = 0.1) - 30)/sqrt(300)) + deltavec[k]
    log_dist <- (rlnorm(n, meanlog = 0, sdlog = 1)- exp(0+1/2))/sqrt(sqrt((exp(1)-1)*exp(2*0 + 1))) + deltavec[k]
    
    tstat_chi[i, k] <- sqrt(n)*mean(chisq_distn)/sd(chisq_distn)
    tstat_norm[i, k] <- sqrt(n)*mean(norm_dist)/sd(norm_dist)
    tstat_exp[i, k] <- sqrt(n)*mean(exp_distn)/sd(exp_distn)
    tstat_t[i, k] <- sqrt(n)*mean(t_distn)/sd(t_distn)
    tstat_unif[i, k] <- sqrt(n)*mean(unif_distn)/sd(unif_distn)
    tstat_gamma[i, k] <- sqrt(n)*mean(gamma_dist)/sd(gamma_dist)
    tstat_log[i, k] <- sqrt(n)*mean(log_dist)/sd(log_dist)
  }
}

```

```{r}
save.image(paste0("test statistics plot under H1",".RData"))
```


## Chi-Squared

### Observations: 

We see that all the  density plots of the test statistic for both the Chi-Squared and Normal distribution are right skewed with skewness increasing with the effect size. Compared to the test statistic of samples from normal distribution, the test statistic of the Chi-squared samples has a stronger peak, but less skewed. As effect size increases, the variance also increases.
```{r}
plot(density(tstat_chi[, 1]), typ = "n", xlim = c(-5, 10), ylim = c(0, 0.6), main = " ", xlab = " ")
title(main = "Chi-Squared with 3 df")
for (k in 1:3){
  lines(density(tstat_chi[, k]), col = "red", lty = k)
  lines(density(tstat_norm[, k]), col = "blue", lty = k)
}
legend('topright', legend = c("chi-squared", "normal"), col=c("red", "blue") , lty =1 ,cex = 0.5)
```


## Exponential

### Observations:

We see that all the  density plots of the test statistic for both the exponential and Normal distribution are right skewed with skewness increasing with the effect size. Compared to the test statistic of samples from normal distribution, the test statistic of the exponential samples has a stronger peak, but less skewed. As effect size increases, the variance also increases.

```{r}
plot(density(tstat_chi[, 1]), typ = "n", xlim = c(-5, 10), ylim = c(0, 0.6), main = " ", xlab = " ")
title(main = "Exp(1)")
for (k in 1:3){
  lines(density(tstat_exp[, k]), col = "red", lty = k)
  lines(density(tstat_norm[, k]), col = "blue", lty = k)
  
}
legend('topright', legend = c("Exponential", "normal"), col=c("red", "blue") , lty =1 ,cex = 0.5)
legend('topleft', legend = k , cex = 0.5)
```

## Uniform

### Observations: 

We see that all the  density plots of the test statistic for both the uniform and Normal distribution are right skewed with skewness increasing with the effect size. Compared to the test statistic of samples from normal distribution, the test statistic of the Chi-squared samples has a stronger peak, but less skewed. As effect size increases, the variance also increases.

```{r}
plot(density(tstat_chi[, 1]), typ = "n", xlim = c(-5, 10), ylim = c(0, 0.5), main = " ", xlab = " ")
title(main = "Uniform(0,1)")
for (k in 1:3){
  lines(density(tstat_unif[, k]), col = "red", lty = k)
  lines(density(tstat_norm[, k]), col = "blue", lty = k)
  
}
legend('topright', legend = c("uniform", "normal"), col=c("red", "blue") , lty =1 ,cex = 0.5)
```

### t 
```{r}
plot(density(tstat_chi[, 1]), typ = "n", xlim = c(-5, 10), ylim = c(0, 0.5), main = " ", xlab = " ")
title(main = "t_3")
for (k in 1:3){
  lines(density(tstat_t[, k]), col = "red", lty = k)
  lines(density(tstat_norm[, k]), col = "blue", lty = k)
  
}
legend('topright', legend = c("t", "normal"), col=c("red", "blue") , lty =1 ,cex = 0.5)
```


### Gamma
```{r}
plot(density(tstat_chi[, 1]), typ = "n", xlim = c(-5, 10), ylim = c(0, 0.5), main = " ", xlab = " ")
title(main = "Gamm(3, 0.1)")
for (k in 1:3){
  lines(density(tstat_gamma[, k]), col = "red", lty = k)
  lines(density(tstat_norm[, k]), col = "blue", lty = k)
  
}
legend('topright', legend = c("Gamma", "normal"), col=c("red", "blue") , lty =1 ,cex = 0.5)
```


### lognormal
```{r}
plot(density(tstat_chi[, 1]), typ = "n", xlim = c(-5, 10), ylim = c(0, 0.6), main = " ", xlab = " ")
title(main = "lognormal(0, 1)")
for (k in 1:3){
  lines(density(tstat_log[, k]), col = "red", lty = k)
  lines(density(tstat_norm[, k]), col = "blue", lty = k)
  
}
legend('topright', legend = c("lognormal", "normal"), col=c("red", "blue") , lty =1 ,cex = 0.5)
```



