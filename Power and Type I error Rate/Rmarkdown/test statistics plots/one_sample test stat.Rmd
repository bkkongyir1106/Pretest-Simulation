---
title: "Density plots of one sample t test statistic"
author: "Benedict Kongyir"
date: "`r format(Sys.time(), '%m/%d/%Y')`"
output: 
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# One sample case

```{r}
rm(list = ls())
setwd("D:/Research_Fall2023/Pretest-Simulation/Power and Type I error Rate/Rmarkdown")
set.seed(1)
N <- 1e5
alpha <- 0.05
d <- 0.5
n <- 10
```


```{r}
norm_statistic <- log_statistic <-t_statistic <- u_statistic<-e_statistic <- k_statistic <-g_statistic <- w_statistic <- NULL
 for(j in 1 : N){
   # ===============================================================================================
    # n1 ~N(0,1),  E(X) = 0  and VAR(X) = 1
    # ===============================================================================================
    n1 <- rnorm(n, mean = 0, sd = 1)
    
    norm_statistic[j] <- t.test(n1)$statistic
    
    # ===============================================================================================
    # e ~exp(theta),  E(X) = theta and VAR(X) = theta^2
    # ===============================================================================================
    
    e1 <- rexp(n, rate = 1)
    e_statistic[j] <- t.test(e1 - 1)$statistic
    
    # ===============================================================================================
    # u1 ~U(a, b),  E(X) = (a + b)/2 and VAR(X) = [(b-a)^2]/12
    # ===============================================================================================
    u1 <- runif(n, min = 0, max = 1)
    
    u_statistic[j] <- t.test((u1-0.5)/sqrt(1/12))$statistic
    
    # ===============================================================================================
    # t1 ~t_v,  E(X) = 0 for v >1 and VAR(X) = v/(v-2)
    # ===============================================================================================
    t1 <-rt(n, df = 3) 
    
    t_statistic[j] <- t.test((t1)/sqrt(3))$statistic
    
    # ===============================================================================================
    # k1 ~X_k,  E(X) = k and VAR(X) = 2k
    # ===============================================================================================
    k1 <-rchisq(n, df = 7) 
    
    k_statistic[j] <- t.test((k1 - 7)/sqrt(14))$statistic
    
    # ===============================================================================================
    # g1 ~gamma(alpha, beta), where beta = 1/theta so E(X) = shape/rate and VAR(X) = shape/(rate)^2
    # ===============================================================================================
    g1 <- rgamma(n, shape = 3, rate = 0.1) 
    
    g_statistic[j] <- t.test((g1-30)/sqrt(300))$statistic
    
    # ===============================================================================================
    # w1 ~Weibull(shape, scale)  E(X) = scale Gamma(1 + 1/shape) and 
    # VAR(X) = scale^2[Gamma(1 + 2/shape) - (Gamma(1 + 1/shape))^2]
    # ===============================================================================================
    w1 <- rweibull(n, shape = 1, scale = 2) 
    u <- (w1-2*gamma(2))/sqrt(4*(gamma(3) - gamma(2)))
    
    
    w_statistic[j] <- t.test(u)$statistic
      
    # ===================================================================================================
    # l1 ~lognormal(mu, sigma^2)  E(X) = exp(mu + sigma^2/2) VAR(X) = [exp(sigma^2)-1]exp(2mu + sigma^2)
    # ===================================================================================================
    l1 <- rlnorm(n, meanlog = 0, sdlog = 1)
    z1 <- (l1- exp(0+1/2))/sqrt(sqrt((exp(1)-1)*exp(2*0 + 1)))
    
    log_statistic[j] <- t.test(z1)$statistic
    
}
```


```{r}
save.image(paste0("one_samples_plots",".RData"))
```

### normal Distribution
The distribution of the t test statistic for samples taken from a normal distribution approximately follows the t distribution as show in the plot below.
```{r}
df = 2*n - 2
z <- seq(from = -3, to = 3, by = 0.01)
#par(mar = c(5, 4, 4, 8), xpd = TRUE)
# normal Distribution
#hist(norm_statistic, prob = T, ylim = c(0, 0.4), xlim = c(-8, 8), main = " ", sub = " ")
plot(z, dt(z, df = n-1), col = "red", type = "l", xlab = " ",  ylab = "Density",  lwd = 2, main = " ", sub = " ")
title(main = "Density plots of t_18 and N(0,1)", sub = "normal Dist")
lines(density(norm_statistic), lwd = 2)
abline(v=qt(0.025, df = df), col = "blue")
abline(v=qt(0.975, df = df), col = "blue")
legend("topright",  legend=c("t_18", "normal(0,1)"),col=c( "red","black"), lty =1 ,cex = 0.5)
```

### Exponential Distribution
The distribution of the t test statistic for samples taken from exponential distribution deviates from the t distribution. It has a fatter tail to the left and slimmer tail to the right as show in the plot below.
```{r}
# Exponential Distribution
#hist(e_statistic, prob = T, ylim = c(0, 0.4), xlim = c(-8, 8), main = " ", sub = " ")
plot(z, dt(z, df = n-1), col = "red",type = "l", lwd = 2, main = " ", sub = " " , xlab = " ",  ylab = "Density")
title(main = "Histogram of t test Statistics", sub = "Exponential Dist")
lines(density(e_statistic) , lwd = 2)
abline(v=qt(0.025, df = df), col = "blue")
abline(v=qt(0.975, df = df), col = "blue")
legend("topright", legend=c("t density", "true density"),col=c( "red","black"), lty =1,cex = 0.5)

```

### t Distribution
The distribution of the t test statistic for samples taken from t distribution is approximately follows the t distribution except that it has a flatter top. The tails are similar to that of the t distribution as show in the plot below.
```{r}
# t Distribution
#hist(t_statistic, prob = T, ylim = c(0, 0.4), xlim = c(-8, 8), main = " ", sub = " ")
plot(z, dt(z, df = n-1), col = "red", type = "l", lwd = 2, main = " ", sub = " " , xlab = " ",  ylab = "Density")
title(main = "Histogram of t test Statistics", sub = "t Dist")
lines(density(t_statistic) , lwd = 2)
abline(v=qt(0.025, df = df), col = "blue")
abline(v=qt(0.975, df = df), col = "blue")
legend("topright", legend=c("t density", "true density"),col=c( "red","black"), lty =1,cex = 0.5)

```

### Uniform Distribution
The distribution of the t test statistic for samples taken from t distribution is approximately follows the t distribution. The tails are similar to that of the t distribution as show in the plot below.
```{r}
# uniform Distribution
#hist(u_statistic, prob = T, ylim = c(0, 0.4), xlim = c(-8, 8), main = " ", sub = " ")

plot(z, dt(z, df = n-1), col = "red",  type = "l", lwd = 2, main = " ", sub = " " , xlab = " ",  ylab = "Density")
title(main = "Histogram of t test Statistics", sub = "Uniform Dist")
lines(density(u_statistic) , lwd = 2)
abline(v=qt(0.025, df = df), col = "blue")
abline(v=qt(0.975, df = df), col = "blue")
legend("topright", legend=c("t density", "true density"),col=c( "red","black"), lty =1,cex = 0.5)

```


### chi-squared Distribution
The distribution of the t test statistic for samples taken from Chi-Squared distribution deviates from the t distribution. It has a fatter tail to the left and slimmer tail to the right as show in the plot below.
```{r}

# chi-squared Distribution
#hist(k_statistic, prob = T, ylim = c(0, 0.4), xlim = c(-8, 8), main = " ", sub = " ")

plot(z, dt(z, df = n-1), col = "red",  type = "l", lwd = 2, main = " ", sub = " " , xlab = " ",  ylab = "Density")
title(main = "Histogram of t test Statistics", sub = "Chi-Square Dist")
lines(density(k_statistic) , lwd = 2)
abline(v=qt(0.025, df = df), col = "blue")
abline(v=qt(0.975, df = df ), col = "blue")
legend("topright", legend=c("t density", "true density"),col=c( "red","black"), lty =1,cex = 0.5)

```

### Weibull Distribution
The distribution of the t test statistic for samples taken from Weibull distribution deviates from the t distribution. It has a fatter tail to the left and slimmer tail to the right as show in the plot below.
```{r}
# weibull Distribution
#hist(w_statistic, prob = T, ylim = c(0, 0.4), xlim = c(-8, 8), main = " ", sub = " ")

plot(z, dt(z, df = n-1), col = "red" , type = "l", lwd = 2, main = " ", sub = " " , xlab = " ",  ylab = "Density")
title(main = "Histogram of t test Statistics", sub = "Weibull Dist")
lines(density(w_statistic) , lwd = 2)
abline(v=qt(0.025, df = df ), col = "blue")
abline(v=qt(0.975, df = df ), col = "blue")
legend("topright", legend=c("t density", "true density"),col=c( "red","black"), lty =1,cex = 0.5)

```


### Gamma Distribution
The distribution of the t test statistic for samples taken from Gamma distribution deviates from the t distribution. It has a fatter tail to the left and slimmer tail to the right as show in the plot below.
```{r}
# gamma Distribution
#hist(g_statistic, prob = T, ylim = c(0, 0.4), xlim = c(-8, 8), main = " ", sub = " ")
plot(z, dt(z, df = n-1), col = "red" , type = "l", lwd = 2, main = " ", sub = " " , xlab = " ",  ylab = "Density")
title(main = "Histogram of t test Statistics", sub = "Gamma Dist")
lines(density(g_statistic) , lwd = 2)
abline(v=qt(0.025, df = df), col = "blue")
abline(v=qt(0.975, df = df), col = "blue")
legend("topright", legend=c("t density", "true density"),col=c( "red","black"), lty =1,cex = 0.5)

```


### Lognormal Distribution
The distribution of the t test statistic for samples taken from Log normal distribution deviates much from the t distribution. It has a fatter tail to the left and slimmer tail to the right as show in the plot below.
```{r}
# lognormal Distribution
#hist(log_statistic, prob = T, ylim = c(0, 0.4), xlim = c(-8, 8), main = " ", sub = " ")

plot(z, dt(z, df = n-1), col = "red" , type = "l", lwd = 2, main = " ", sub = " " , xlab = " ",  ylab = "Density")
title(main = "Histogram of t test Statistics", sub = "Lognormal Dist")
lines(density(log_statistic), lwd = 2)
abline(v=qt(0.025, df = df), col = "blue")
abline(v=qt(0.975, df = df), col = "blue")
legend("topright", legend=c("t density", "true density"),col=c( "red","black"), lty =1,cex = 0.5)

```

```{r}
# Calculation of Type 1 error

#normal Distn
left_norm <- mean(norm_statistic < qt(0.025, df = df))
right_norm <- mean(norm_statistic > qt(0.975, df = df))
Type1_error_norm <- sum(left_norm + right_norm)

#exponential Distn
left_e <- mean(e_statistic < qt(0.025, df = df))
right_e <- mean(e_statistic > qt(0.975, df = df))
Type1_error_e <- sum(left_e + right_e)
#t Distn
left_t <- mean(t_statistic < qt(0.025, df = df))
right_t <- mean(t_statistic > qt(0.975, df = df))
Type1_error_t <- sum(left_t + right_t)
#uuniform Distn
left_u <- mean(u_statistic < qt(0.025, df = df))
right_u <- mean(u_statistic > qt(0.975, df = df))
Type1_error_u <- sum(left_u + right_u)
#Chi-Squared Distn
left_k <- mean(k_statistic < qt(0.025, df = df))
right_k <- mean(k_statistic > qt(0.975, df = df))
Type1_error_k <- sum(left_k + right_k)
#Weilbul Distn
left_w <- mean(w_statistic < qt(0.025, df = df))
right_w <- mean(w_statistic > qt(0.975, df = df))
Type1_error_w <- sum(left_w + right_w)
#Gamma Distn
left_g <- mean(g_statistic < qt(0.025, df = df))
right_g <- mean(g_statistic > qt(0.975, df = df))
Type1_error_g <- sum(left_g + right_g)
#Lognormal Distn
left_l <- mean(log_statistic < qt(0.025, df = df))
right_l <- mean(log_statistic > qt(0.975, df = df))
Type1_error_l <- sum(left_l + right_l)
```

### Estimated Type I errors

```{r}
# power of SW test
errors <-c( Type1_error_norm, Type1_error_e, Type1_error_t, Type1_error_u,Type1_error_k,Type1_error_w, Type1_error_g,Type1_error_l)
dist <-c("normal", "exponential", "t", "uniform", "chi-squared", "weillbul", "gamma", "lognormal")

# put data in a table
kk <- data.frame(dist, errors)
knitr::kable(kk, caption = "Estimated Type I errors")
