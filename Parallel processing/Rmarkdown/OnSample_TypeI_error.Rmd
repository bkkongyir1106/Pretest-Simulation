---
title: "Utility of Normality of t test: Power loss for One Sample t test"
author: "Benedict Kongyir"
date: "`r format(Sys.time(), '%m/%d/%Y')`"
output: 
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.height = 6.5, fig.width = 8)
```


```{r}
#setwd("/Users/benedictkongyir/Desktop/OSU/Research/Permutation Test/New Simulations/cluster/Results")
load("/Users/benedictkongyir/Desktop/OSU/Research/Permutation Test/New Simulations/cluster/Parrel_sim_RData/TwoSamples_power_norm_par.RData")
load("/Users/benedictkongyir/Desktop/OSU/Research/Pretest-Simulation/Parallel processing/parallel_sim/Type I error/OneSample_error_inflation.RData")
```



```{r}
data_powertest <-data.frame(power_norm.test_par)
error <-data.frame(error_inflation)
# power of SW test
data_Normality <-data.frame(power_norm.test_par[, , 2])
# power loss at 5% sig level
data_error <-data.frame(error_inflation[, , 2])
Expected_error_inflation <-data_error * (1 - data_Normality)
```

 
### Expected Inflation of Type I error rates

 
### Expected Power loss

\[\text{Let IE } = \text{Inflation of Type I error of the t test}\\
\Psi = \text{Probability of failling to reject the Normality test.}\\
\implies E[IE] = IE\times \Psi\]

```{r}
par(mar = c(4.5, 4.1, 4.1, 8.5), xpd = TRUE)
plot(nvec, Expected_error_inflation$Exponential, type="l", lwd= 2, col = "red", 
     ylim = c(-0.01, 0.05), xlim = range(nvec), xlab = "Sample Size", ylab = "Expected Inflation of Type I Error Rates")
lines(nvec, Expected_error_inflation$Laplace, lwd= 2, col = "blue")
lines(nvec, Expected_error_inflation$Chi.Square,lwd= 2, col = "darkgrey")
lines(nvec, Expected_error_inflation$Gamma,lwd= 2, col = "green")
lines(nvec, Expected_error_inflation$Weibull, col = "coral4")
lines(nvec, Expected_error_inflation$t, col = "orange")
lines(nvec, Expected_error_inflation$LogNormal, col = "deeppink")
lines(nvec,Expected_error_inflation$Standard.Normal, col = "black")
lines(nvec, Expected_error_inflation$Contaminated, col = "purple")
lines(nvec, Expected_error_inflation$Uniform, col = "cyan")
abline(h = 0, col = "black", lwd = 2, xpd = FALSE)
title(main = "Expected Inflation of Type I Error Rates")
legend("topright", inset = c(-0.28, 0), legend=c("Exp", "Laplace", "Chisq", "Gamma", "Weibull", "t", "LogNormal","Std Normal", "contaminate", "Uniform"),
       col=c( "red","blue", "darkgrey", "green", "coral4", "orange", "deeppink", "black", "purple", "cyan"), lty =1,cex = 0.8, title = "Distribution")
```




### Utility of SW test---Normal Distributions
```{r}

## add extra space to right margin of plot within frame
par(mar = c(9.1, 4.1, 4.1, 6.1), xpd = TRUE)
plot(nvec, data_powertest$Standard.Normal.SW, axes=FALSE, ylim=c(0,1), xlab="", ylab="", 
   type="o", lwd = 2, col="black", main="Utility of SW test ... Normal Samples")
axis(2, ylim=c(0,1),col="black",las=1)  
mtext("Power of SW test",side=2,line=2.5)
box()
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(nvec, error$Standard.Normal.0.05,  xlab="", ylab="", ylim=c(-0.02,0.02), 
    axes=FALSE, type="l", lty = 1, lwd = 2, col="red")
mtext("Inflation of Type I error",side=4,col="black",line=4) 
axis(4, ylim=c(0,0.05), col="red",col.axis="black",las=1)
## a little farther out (line=4) to make room for labels
axis(4, ylim=c(0,0.02), col="blue",col.axis="blue",las=1)
abline(h = 0, col = "grey", lwd = 2, xpd = FALSE)
## Draw the time axis
axis(1,pretty(range(nvec),10))
mtext("Sample Size",side=1,col="black",line=2.5)  
## Add Legend
legend("bottom", inset = c(0, -0.35), legend=c("power of SW test","Inflation of Type I error"),
  col=c("black","red"), lty = c(1, 2), horiz = TRUE)
```



### Utility of SW test---t Distributions
```{r}

## add extra space to right margin of plot within frame
par(mar = c(8, 4, 4, 4), xpd = TRUE)
plot(nvec, data_powertest$t.SW, axes=FALSE, ylim=c(0,1), xlab="", ylab="", 
   type="o", lwd = 2, col="black", main="Utility of SW test ... t Samples")
axis(2, ylim=c(0,1),col="black",las=1)  
mtext("Power of SW test",side=2,line=2.5)
box()
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(nvec, error$t.0.05,  xlab="", ylab="", ylim=c(-0.02,0.02), 
    axes=FALSE, type="l", lty = 1, lwd = 2, col="red")
mtext("Inflation of Type I error",side=4,col="black",line=4) 
axis(4, ylim=c(0,0.5), col="red",col.axis="black",las=1)
## a little farther out (line=4) to make room for labels
axis(4, ylim=c(0,0.2), col="blue",col.axis="blue",las=1)
abline(h = 0, col = "grey", lwd = 2, xpd = FALSE)
## Draw the time axis
axis(1,pretty(range(nvec),10))
mtext("Sample Size",side=1,col="black",line=2.5)  
## Add Legend
legend("bottom", inset = c(0, -0.35), legend=c("power of SW test","Inflation of Type I error"),
  col=c("black","red"), lty = c(1, 2), horiz = TRUE)
```


### Utility of SW test---Uniform Distributions
```{r}

## add extra space to right margin of plot within frame
par(mar = c(8, 4, 4, 4), xpd = TRUE)
plot(nvec, data_powertest$Uniform.SW, axes=FALSE, ylim=c(0,1), xlab="", ylab="", 
   type="o", lwd = 2, col="black", main="Utility of SW test ... Uniform Samples")
axis(2, ylim=c(0,1),col="black",las=1)  
mtext("Power of SW test",side=2,line=2.5)
box()
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(nvec, error$Uniform.0.05,  xlab="", ylab="", ylim=c(-0.03,0.02),
    axes=FALSE, type="l", lty = 1, lwd = 2, col="red")
mtext("Inflation of Type I error",side=4,col="black",line=4) 
axis(4, ylim=c(0,0.5), col="red",col.axis="black",las=1)
## a little farther out (line=4) to make room for labels
axis(4, ylim=c(0,0.2), col="blue",col.axis="blue",las=1)
abline(h = 0, col = "grey", lwd = 2, xpd = FALSE)
## Draw the time axis
axis(1,pretty(range(nvec),10))
mtext("Sample Size",side=1,col="black",line=2.5)  
## Add Legend
legend("bottom", inset = c(0, -0.35), legend=c("power of SW test","Inflation of Type I error"),
  col=c("black","red"), lty = c(1, 2), horiz = TRUE)
```



### Utility of SW test---Exponential Distributions
```{r}

## add extra space to right margin of plot within frame
par(mar = c(8, 4, 4, 4), xpd = TRUE)
plot(nvec, data_powertest$Exponential.SW, axes=FALSE, ylim=c(0,1), xlab="", ylab="", 
   type="o", lwd = 2, col="black", main="Utility of SW test ... Exponential Samples")
axis(2, ylim=c(0,1),col="black",las=1)  
mtext("Power of SW test",side=2,line=2.5)
box()
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(nvec, error$Exponential.0.05,  xlab="", ylab="", ylim=c(0,0.1),
    axes=FALSE, type="l", lty = 1, lwd = 2, col="red")
mtext("Inflation of Type I error",side=4,col="black",line=4) 
axis(4, ylim=c(0,0.5), col="red",col.axis="black",las=1)
## a little farther out (line=4) to make room for labels
axis(4, ylim=c(0,0.2), col="blue",col.axis="blue",las=1)
abline(h = 0, col = "grey", lwd = 2, xpd = FALSE)
## Draw the time axis
axis(1,pretty(range(nvec),10))
mtext("Sample Size",side=1,col="black",line=2.5)  
## Add Legend
legend("bottom", inset = c(0, -0.35), legend=c("power of SW test","Inflation of Type I error"),
  col=c("black","red"), lty = c(1, 2), horiz = TRUE)
```




### Utility of SW test---Laplace Distributions
```{r}

## add extra space to right margin of plot within frame
par(mar = c(8, 4, 4, 4), xpd = TRUE)
plot(nvec, data_powertest$Laplace.SW, axes=FALSE, ylim=c(0,1), xlab="", ylab="", 
   type="o", lwd = 2, col="black", main="Utility of SW test ... Laplace Samples")
axis(2, ylim=c(0,1),col="black",las=1)  
mtext("Power of SW test",side=2,line=2.5)
box()
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(nvec, error$Laplace.0.05,  xlab="", ylab="", ylim=c(-0.02,0.02),
    axes=FALSE, type="l", lty = 1, lwd = 2, col="red")
mtext("Inflation of Type I error",side=4,col="black",line=4) 
axis(4, ylim=c(0,0.5), col="red",col.axis="black",las=1)
## a little farther out (line=4) to make room for labels
axis(4, ylim=c(0,0.2), col="blue",col.axis="blue",las=1)
abline(h = 0, col = "grey", lwd = 2, xpd = FALSE)
## Draw the powerloss axis
axis(1,pretty(range(nvec),10))
mtext("Sample Size",side=1,col="black",line=2.5)  
## Add Legend
legend("bottom", inset = c(0, -0.35), legend=c("power of KS test","Inflation of Type I error"),
  col=c("black","red"), lty = c(1, 2), horiz = TRUE)
```


### Utility of SW test---Chi-Square Distributions
```{r}

## add extra space to right margin of plot within frame
par(mar = c(8, 4, 4, 4), xpd = TRUE)
plot(nvec, data_powertest$Chi.Square.SW, axes=FALSE, ylim=c(0,1), xlab="", ylab="", 
   type="o", lwd = 2, col="black", main="Utility of SW test ... Chi-Square Samples")
axis(2, ylim=c(0,1),col="black",las=1)  
mtext("Power of SW test",side=2,line=2.5)
box()
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(nvec, error$Chi.Square.0.05,  xlab="", ylab="", ylim=c(0.0,0.05),
    axes=FALSE, type="l", lty = 1, lwd = 2, col="red")
mtext("Inflation of Type I error",side=4,col="black",line=4) 
axis(4, ylim=c(0,0.5), col="red",col.axis="black",las=1)
## a little farther out (line=4) to make room for labels
axis(4, ylim=c(0,0.2), col="blue",col.axis="blue",las=1)
abline(h = 0, col = "grey", lwd = 2, xpd = FALSE)
## Draw the time axis
axis(1,pretty(range(nvec),10))
mtext("Sample Size",side=1,col="black",line=2.5)  
## Add Legend
legend("bottom", inset = c(0, -0.35), legend=c("power of KS test","Inflation of Type I error"),
  col=c("black","red"), lty = c(1, 2), horiz = TRUE)
```




### Utility of SW test---Gamma Distributions
```{r}

## add extra space to right margin of plot within frame
par(mar = c(8, 4, 4, 4), xpd = TRUE)
plot(nvec, data_powertest$Gamma.SW, axes=FALSE, ylim=c(0,1), xlab="", ylab="", 
   type="o", lwd = 2, col="black", main="Utility of JB test ... Gamma Samples")
axis(2, ylim=c(0,1),col="black",las=1)  
mtext("Power of SW test",side=2,line=2.5)
box()
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(nvec, error$Gamma.0.05,  xlab="", ylab="", ylim=c(0.0,0.05), 
    axes=FALSE, type="l", lty = 1, lwd = 2, col="red")
mtext("Inflation of Type I error",side=4,col="black",line=4) 
axis(4, ylim=c(0,0.5), col="red",col.axis="black",las=1)
## a little farther out (line=4) to make room for labels
axis(4, ylim=c(0,0.2), col="blue",col.axis="blue",las=1)
abline(h = 0, col = "grey", lwd = 2, xpd = FALSE)
## Draw the time axis
axis(1,pretty(range(nvec),10))
mtext("Sample Size",side=1,col="black",line=2.5)  
## Add Legend
legend("bottom", inset = c(0, -0.35), legend=c("power of JB test","Inflation of Type I error"),
  col=c("black","red"), lty = c(1, 2), horiz = TRUE)
```



